<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Metrics &mdash; TreeCorr  documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="TreeCorr  documentation" href="index.html" />
    <link rel="next" title="Two-point Correlation Functions" href="correlation2.html" />
    <link rel="prev" title="Fields" href="field.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="correlation2.html" title="Two-point Correlation Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="field.html" title="Fields"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">TreeCorr  documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="metrics">
<h1>Metrics<a class="headerlink" href="#metrics" title="Permalink to this headline">¶</a></h1>
<p>The correlation functions need to know how to calculate distances between the points,
that is, the metric defining the space.</p>
<p>In most cases, you will probably want to use the default Metric, which is called &#8220;Euclidean&#8221;,
which just uses the normal Euclidean distance between two points.  However, there are a few
other options, which are useful for various applications.</p>
<p>Both <a class="reference internal" href="correlation2.html#treecorr.BinnedCorr2" title="treecorr.BinnedCorr2"><tt class="xref py py-class docutils literal"><span class="pre">BinnedCorr2</span></tt></a> and <a class="reference internal" href="correlation3.html#treecorr.BinnedCorr3" title="treecorr.BinnedCorr3"><tt class="xref py py-class docutils literal"><span class="pre">BinnedCorr3</span></tt></a> take an optional
<tt class="docutils literal"><span class="pre">metric</span></tt> parameter, which should be one of the following string values:</p>
<div class="section" id="euclidean">
<h2>&#8220;Euclidean&#8221;<a class="headerlink" href="#euclidean" title="Permalink to this headline">¶</a></h2>
<p>This is the default metric, and is the only current option for 2-dimensional flat correlations,
i.e. when the coordinates are given by (x,y), rather than either (x,y,z), (ra,dec), or (ra,dec,r).</p>
<p>For 2-dimensional coordinate systems, the distance is defined as</p>
<p><span class="math">\(d_{\rm Euclidean} = \sqrt{(x_2-x_1)^2 + (y_2-y_1)^2}\)</span></p>
<p>For 3-dimensional coordinate systems, the distance is defined as</p>
<p><span class="math">\(d_{\rm Euclidean} = \sqrt{(x_2-x_1)^2 + (y_2-y_1)^2 + (z_2-z_1)^2}\)</span></p>
<p>For spherical coordinates with distances, (ra,dec,r), the coordinates are first
converted to Cartesian coordinates and the above formula is used.</p>
<p>For spherical coordinates without distances, (ra, dec), the coordinates are placed on the
unit sphere and the above formula is used.  This means that all distances are really chord
distances across the sphere, not great circle distances.  For small angles, this is a small
correction, but as the angles get large, the difference between the great circle distance and
the chord distance becomes significant.  The conversion formula is</p>
<p><span class="math">\(d_{\rm GC} = 2 \arcsin(d_{\rm Euclidean} / 2)\)</span></p>
<p>TreeCorr applies this formula at the end as part of the <tt class="docutils literal"><span class="pre">finalize</span></tt> function
(e.g. <a class="reference internal" href="gg.html#treecorr.GGCorrelation.finalize" title="treecorr.GGCorrelation.finalize"><tt class="xref py py-meth docutils literal"><span class="pre">finalize()</span></tt></a>), so the <tt class="docutils literal"><span class="pre">meanr</span></tt> and <tt class="docutils literal"><span class="pre">meanlogr</span></tt> attributes
will be in terms of great circle distances.  However, they will not necessarily be spaced
precisely uniformly in log(r), since the original bin spacing will have been set up in terms
of the chord distances.</p>
</div>
<div class="section" id="arc">
<h2>&#8220;Arc&#8221;<a class="headerlink" href="#arc" title="Permalink to this headline">¶</a></h2>
<p>This metric is only valid for spherical coordinates (ra,dec).</p>
<p>The distance is defined as</p>
<p><span class="math">\(d_{\rm Arc} = 2 \arcsin(d_{\rm Euclidean} / 2)\)</span></p>
<p>where <span class="math">\(d_{\rm Euclidean}\)</span> is the above &#8220;Euclidean&#8221; chord distance.</p>
<p>This metric is significantly slower than the &#8220;Euclidean&#8221; metric, since it requires trigonometric
functions for every pair calculation along the way, rather than just at the end.
In most cases, this extra care is unnecessary, but it provides a means to check if the
chord calculations are in any way problematic for your particular use case.</p>
<p>Also, unline the &#8220;Euclidean&#8221; version, the bin spacing will be uniform in log(r) using the
actual great circle distances, rather than being based on the chord distances.</p>
</div>
<div class="section" id="rperp">
<h2>&#8220;Rperp&#8221;<a class="headerlink" href="#rperp" title="Permalink to this headline">¶</a></h2>
<p>This metric is only valid for 3-dimensional coordinates (ra,dec,r) or (x,y,z).</p>
<p>The distance is defined as</p>
<p><span class="math">\(d_{\rm Rperp} = \sqrt{d_{\rm Euclidean}^2 - (r_2-r_1)^2}\)</span></p>
<p>That is, it breaks up the full 3-d distance into perpendicular and parallel components:
<span class="math">\(d_{\rm 3d}^2 = r_\bot^2 + r_\parallel^2\)</span>, where <span class="math">\(r_\parallel \equiv r_2-r_1\)</span>,
and it identifies the metric separation as just the perpendicular component, <span class="math">\(r_\bot\)</span>.</p>
<p>Note that this decomposition is really only valid for objects with a relatively small angular
separation, <span class="math">\(\theta\)</span>, on the sky, so the two radial vectors are nearly parallel.
In this limit, the formula for <span class="math">\(d\)</span> reduces to</p>
<p><span class="math">\(d_{\rm Rperp} \approx \left(\sqrt{r_1 r_2}\right) \theta\)</span></p>
<p>This metric also permits the use of two other parameters, <tt class="docutils literal"><span class="pre">min_rpar</span></tt> and <tt class="docutils literal"><span class="pre">max_rpar</span></tt>,
which set the minimum and maximum values of <span class="math">\(r_\parallel\)</span> for pairs to be included in the
correlations.</p>
<p>The sign of <span class="math">\(r_\parallel\)</span> is defined such that positive values mean
the object from the second catalog is farther away.  Thus, if the first catalog represents
lenses and the second catalog represents lensed source galaxies, then setting
<tt class="docutils literal"><span class="pre">min_rpar</span> <span class="pre">=</span> <span class="pre">0</span></tt> will restrict the sources to being in the background of each lens.
Similarly, setting <tt class="docutils literal"><span class="pre">min_rpar</span> <span class="pre">=</span> <span class="pre">-50</span></tt>, <tt class="docutils literal"><span class="pre">max_rpar</span> <span class="pre">=</span> <span class="pre">50</span></tt> will restrict the sources to be
within 50 Mpc (say, assuming the catalog distances are given in Mpc) of the lenses.</p>
</div>
<div class="section" id="rlens">
<h2>&#8220;Rlens&#8221;<a class="headerlink" href="#rlens" title="Permalink to this headline">¶</a></h2>
<p>This metric is only valid when the first catalog uses 3-dimensional coordinates
(ra,dec,r) or (x,y,z).  The second catalog may take either 3-d coordinates or spherical
coordinates (ra,dec).</p>
<p>The distance is defined as</p>
<p><span class="math">\(d_{\rm Rlens} = 2 r_1 \sin(\theta / 2)\)</span></p>
<p>where <span class="math">\(\theta\)</span> is the opening angle between the two objects and <span class="math">\(r_1\)</span> is the
radial distance to the object in the first catalog (nominally the &#8220;lens&#8221; catalog).
In other words, this is the chord distance between the two lines of sight at the radius
of the lens galaxy.</p>
<p>This metric also permits the use of two other parameters, <tt class="docutils literal"><span class="pre">min_rpar</span></tt> and <tt class="docutils literal"><span class="pre">max_rpar</span></tt>,
which set the minimum and maximum values of <span class="math">\(r_\parallel = r_2 - r_1\)</span> for pairs to be
included in the correlations.</p>
<p>The sign of <span class="math">\(r_\parallel\)</span> is defined such that positive values mean
the object from the second catalog is farther away. Thus, setting
<tt class="docutils literal"><span class="pre">min_rpar</span> <span class="pre">=</span> <span class="pre">0</span></tt> will restrict the sources to being in the background of each lens.
Similarly, setting <tt class="docutils literal"><span class="pre">min_rpar</span> <span class="pre">=</span> <span class="pre">-50</span></tt>, <tt class="docutils literal"><span class="pre">max_rpar</span> <span class="pre">=</span> <span class="pre">50</span></tt> will restrict the sources to be
within 50 Mpc (say, assuming the catalog distances are given in Mpc) of the lenses.</p>
<p>Since the basic metric does not use the radial distance to the source galaxies (<span class="math">\(r_2\)</span>),
they are not required.  You may just provide (ra,dec) coordinates for the sources.
However, if you want to use the <tt class="docutils literal"><span class="pre">min_rpar</span></tt> or <tt class="docutils literal"><span class="pre">max_rpar</span></tt> options, then
the source coordinates need to include r.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Metrics</a><ul>
<li><a class="reference internal" href="#euclidean">&#8220;Euclidean&#8221;</a></li>
<li><a class="reference internal" href="#arc">&#8220;Arc&#8221;</a></li>
<li><a class="reference internal" href="#rperp">&#8220;Rperp&#8221;</a></li>
<li><a class="reference internal" href="#rlens">&#8220;Rlens&#8221;</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="field.html"
                        title="previous chapter">Fields</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="correlation2.html"
                        title="next chapter">Two-point Correlation Functions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/metric.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="correlation2.html" title="Two-point Correlation Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="field.html" title="Fields"
             >previous</a> |</li>
        <li><a href="index.html">TreeCorr  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2015, Mike Jarvis.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>